"use strict";const n=require("electron"),p=require("node:os"),s=require("node:path");process.env.DIST_ELECTRON=s.join(__dirname,"..");process.env.DIST=s.join(process.env.DIST_ELECTRON,"../dist");process.env.PUBLIC=process.env.VITE_DEV_SERVER_URL?s.join(process.env.DIST_ELECTRON,"../public"):process.env.DIST;p.release().startsWith("6.1")&&n.app.disableHardwareAcceleration();process.platform==="win32"&&n.app.setAppUserModelId(n.app.getName());n.app.requestSingleInstanceLock()||(n.app.quit(),process.exit(0));let e=null;const r=s.join(__dirname,"../preload/index.js"),a=process.env.VITE_DEV_SERVER_URL,c=s.join(process.env.DIST,"index.html");async function l(){e=new n.BrowserWindow({title:"Hephaistos",icon:s.join(process.env.PUBLIC,"favicon.ico"),width:1200,height:750,webPreferences:{preload:r,nodeIntegration:!0,contextIsolation:!1}}),e.setMenu(null),e.setOpacity(.98),process.env.VITE_DEV_SERVER_URL?(e.loadURL(a),e.webContents.openDevTools()):e.loadFile(c),e.webContents.on("did-finish-load",()=>{e==null||e.webContents.send("main-process-message",new Date().toLocaleString())}),e.webContents.setWindowOpenHandler(({url:o})=>(o.startsWith("https:")&&n.shell.openExternal(o),{action:"deny"}))}n.app.whenReady().then(l);n.app.on("window-all-closed",()=>{e=null,process.platform!=="darwin"&&n.app.quit()});n.app.on("second-instance",()=>{e&&(e.isMinimized()&&e.restore(),e.focus())});n.app.on("activate",()=>{const o=n.BrowserWindow.getAllWindows();o.length?o[0].focus():l()});n.ipcMain.handle("open-win",(o,t)=>{const i=new n.BrowserWindow({webPreferences:{preload:r,nodeIntegration:!0,contextIsolation:!1}});process.env.VITE_DEV_SERVER_URL?i.loadURL(`${a}#${t}`):i.loadFile(c,{hash:t})});
